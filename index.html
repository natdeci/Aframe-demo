<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ISGS</title>

    <!-- A-Frame + Plugins -->
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@5.1.0/dist/aframe-event-set-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/nipplejs@0.8.5/dist/nipplejs.min.js"></script>
    <script src="js/joystick.min.js"></script>
    <script src="js/info-panel.js"></script>
    <script src="js/highlight.js"></script>
</head>

<body>
    <a-scene environment cursor="rayOrigin: mouse; fuse: false" raycaster="objects: .raycastable" joystick>
        <!-- Model -->
        <a-entity gltf-model="#isomatric" position="5.029 0.152 -6.951" scale="1 1 1"></a-entity>

        <!-- Camera Rig -->
        <a-entity id="rig" movement-controls="controls: keyboard,nipple; speed: 0.17" nipple-controls="mode: static; lookJoystickEnabled: false; moveJoystickPosition: right" position="1.211 1.25 2.202">
            <a-entity id="cam" camera rotation="0 0 0" look-controls="pointerLockEnabled: false"></a-entity>
        </a-entity>

        <script>
            window.onload = function () {
                const playButton = document.getElementById("playButton");
                const video = document.getElementById("bkkbn_vid");

                playButton.addEventListener("click", () => {
                    if (video.paused) {
                        video.play();
                        playButton.setAttribute("visible", "false");
                    }
                });
            };
        </script>

        <!-- Video Screen -->
        <a-entity position="-4.91 1.34 1.44" rotation="0 90 0" scale="0.43 0.43 1">
            <a-video src="#bkkbn_vid" width="4" height="2.5" id="videoElement"></a-video>
        </a-entity>

        <!-- Play Button -->
        <a-image id="playButton" src="#playpause" position="-4.88 0.970 1.507" width="0.25" height="0.25"
            rotation="0 90 0" class="raycastable" scale="0.4 0.4 0.4"
            animation__mouseenter="property: scale; to: 0.5 0.5 0.5; dur: 200; startEvents: mouseenter"
            animation__mouseleave="property: scale; to: 0.4 0.4 0.4; dur: 200; startEvents: mouseleave">
        </a-image>

        <!-- Ground -->
        <a-entity position="0 0 -2" geometry="primitive: box; width: 10; height: 0.1; depth: 10"
            material="color: #ccc;"></a-entity>

        <a-assets>
            <img src="assets/ppt/slide (1).png" alt="" id="slide1" />
            <img src="assets/ppt/slide (2).png" alt="" id="slide2" />
            <img src="assets/ppt/slide (3).png" alt="" id="slide3" />
            <img src="assets/ppt/slide (4).png" alt="" id="slide4" />
            <img src="assets/ppt/slide (5).png" alt="" id="slide5" />
            <img src="assets/ppt/slide (6).png" alt="" id="slide6" />
            <img src="assets/ppt/slide (7).png" alt="" id="slide7" />
            <img src="assets/ppt/slide (8).png" alt="" id="slide8" />
            <img src="assets/ppt/slide (9).png" alt="" id="slide9" />
            <img src="assets/ppt/slide (10).png" alt="" id="slide10" />
            <img src="assets/ppt/slide (11).png" alt="" id="slide11" />
            <img src="assets/ppt/slide (12).png" alt="" id="slide12" />
            <img src="assets/ppt/slide (13).png" alt="" id="slide13" />
            <img src="assets/ppt/slide (14).png" alt="" id="slide14" />
            <img src="assets/ppt/slide (15).png" alt="" id="slide15" />
            <img src="assets/ppt/slide (16).png" alt="" id="slide16" />
            <img src="assets/ppt/slide (17).png" alt="" id="slide17" />
            <img src="assets/ppt/slide (18).png" alt="" id="slide18" />
            <img src="assets/ppt/slide (19).png" alt="" id="slide19" />
            <img src="assets/ppt/slide (20).png" alt="" id="slide20" />
            <img src="assets/ppt/slide (21).png" alt="" id="slide21" />
            <img src="assets/ppt/slide (22).png" alt="" id="slide22" />
            <img src="assets/ppt/slide (23).png" alt="" id="slide23" />
            <img src="assets/ppt/slide (24).png" alt="" id="slide24" />
            <img src="assets/ppt/slide (25).png" alt="" id="slide25" />
            <img src="assets/ppt/slide (26).png" alt="" id="slide26" />
            <img src="assets/ppt/slide (27).png" alt="" id="slide27" />
            <img src="assets/ppt/slide (28).png" alt="" id="slide28" />
            <img src="assets/ppt/slide (29).png" alt="" id="slide29" />
            <img src="assets/ppt/slide (30).png" alt="" id="slide30" />
            <img src="assets/ppt/slide (31).png" alt="" id="slide31" />
            <img src="assets/ppt/slide (32).png" alt="" id="slide32" />
            <img src="assets/ppt/slide (33).png" alt="" id="slide33" />
            <img src="assets/ppt/slide (34).png" alt="" id="slide34" />
            <img src="assets/ppt/slide (35).png" alt="" id="slide35" />
            <img src="assets/ppt/slide (36).png" alt="" id="slide36" />
            <img src="assets/ppt/slide (37).png" alt="" id="slide37" />
            <img src="assets/ppt/slide (38).png" alt="" id="slide38" />
            <img src="assets/ppt/slide (39).png" alt="" id="slide39" />
            <img src="assets/ppt/slide (40).png" alt="" id="slide40" />
            <img src="assets/ppt/slide (41).png" alt="" id="slide41" />
            <img src="assets/joystick/left.png" alt="" id="left" />
            <img src="assets/joystick/right.png" alt="" id="right" />
            <img src="assets/Frame Monitor Kanan.png" alt="" id="framekanan" />
            <img src="assets/play-pause.png" alt="" id="playpause" />
            <video id="bkkbn_vid" src="assets/video.mp4" preload="auto" playsinline webkit-playsinline
                crossorigin="anonymous"></video>

            <a-asset-item id="officeModel" src="models/meeting_room.glb"></a-asset-item>
            <a-asset-item id="isomatric" src="models/isometric_office.glb"></a-asset-item>
        </a-assets>

        <script>
            document.addEventListener("DOMContentLoaded", () => {
                const slides = [
                    "#slide1",
                    "#slide2",
                    "#slide3",
                    "#slide4",
                    "#slide5",
                    "#slide6",
                    "#slide7",
                    "#slide8",
                    "#slide9",
                    "#slide10",
                    "#slide11",
                    "#slide12",
                    "#slide13",
                    "#slide14",
                    "#slide15",
                    "#slide16",
                    "#slide17",
                    "#slide18",
                    "#slide19",
                    "#slide20",
                    "#slide21",
                    "#slide22",
                    "#slide23",
                    "#slide24",
                    "#slide25",
                    "#slide26",
                    "#slide27",
                    "#slide28",
                    "#slide29",
                    "#slide30",
                    "#slide31",
                    "#slide32",
                    "#slide33",
                    "#slide34",
                    "#slide35",
                    "#slide36",
                    "#slide37",
                    "#slide38",
                    "#slide39",
                    "#slide40",
                    "#slide41",
                ];
                let currentIndex = 0;

                const monitor = document.querySelector("#monitor1");
                const prevBtn = document.querySelector("#prevBtn");
                const nextBtn = document.querySelector("#nextBtn");

                prevBtn.addEventListener("click", () => {
                    currentIndex = (currentIndex - 1 + slides.length) % slides.length;
                    monitor.setAttribute("src", slides[currentIndex]);
                });

                nextBtn.addEventListener("click", () => {
                    currentIndex = (currentIndex + 1) % slides.length;
                    monitor.setAttribute("src", slides[currentIndex]);
                });
            });
        </script>

        <!-- Monitor [Middle] -->
        <a-entity id="Middle Room">
            <a-entity id="monitorPPT">
                <a-image id="monitor1" src="#slide1" position="0.506 1.100 -2.351" rotation="0 -8.482 0"
                    scale="0.540 0.320 1" class="raycastable"></a-image>

                <a-image id="prevBtn" src="#left" position="0.271 0.977 -2.386" width="0.2" height="0.2"
                    class="raycastable" scale="0.200 0.200 1" rotation="0 -8.482 0"></a-image>

                <a-image id="nextBtn" src="#right" position="0.740 0.977 -2.316" width="0.2" height="0.2"
                    class="raycastable" scale="0.250 0.250 1" rotation="0 -8.482 0"></a-image>

                <a-image id="backBtn" src="#left" position="0.271 1.200 -2.386" rotation="0 -8.482 0" width="0.2"
                    height="0.2" class="raycastable" scale="0.200 0.200 1" class="clickable" visible="false"></a-image>
            </a-entity>

            <script>
                const monitor = document.querySelector("#monitor1");
                const camera_ppt = document.querySelector("#cam");
                const rig_ppt = document.querySelector("#rig");
                const btnBack_ppt = document.querySelector("#backBtn");

                const rigZoomPos_ppt = "0.453 1.100 -1.971";
                const camZoomRot_ppt = "0 -8.709 0";

                const rigInitPos_ppt = "0.425 1.250 -1.887";
                const camInitRot_ppt = "-2.750 8.136 0";

                monitor.addEventListener("click", () => {
                    rig_ppt.removeAttribute("animation__pos");
                    camera_ppt.removeAttribute("animation__rot");

                    // Animasi zoom in
                    rig_ppt.setAttribute("animation__pos", {
                        property: "position",
                        to: rigZoomPos_ppt,
                        dur: 1000,
                        easing: "easeInOutQuad"
                    });

                    camera_ppt.setAttribute("animation__rot", {
                        property: "rotation",
                        to: camZoomRot_ppt,
                        dur: 1000,
                        easing: "easeInOutQuad"
                    });

                    // Disable controls
                    camera_ppt.setAttribute("look-controls", "enabled: false");
                    rig_ppt.setAttribute("movement-controls", "enabled: false");
                    rig_ppt.setAttribute("nipple-controls", "enabled: false");

                    btnBack_ppt.setAttribute("visible", true);
                });

                btnBack_ppt.addEventListener("click", () => {
                    rig_ppt.removeAttribute("animation__pos");
                    camera_ppt.removeAttribute("animation__rot");

                    // Animasi zoom in
                    rig_ppt.setAttribute("animation__pos", {
                        property: "position",
                        to: rigInitPos_ppt,
                        dur: 1000,
                        easing: "easeInOutQuad"
                    });

                    camera_ppt.setAttribute("animation__rot", {
                        property: "rotation",
                        to: camInitRot_ppt,
                        dur: 1000,
                        easing: "easeInOutQuad"
                    });

                    // Disable controls
                    camera_ppt.setAttribute("look-controls", "enabled: true");
                    rig_ppt.setAttribute("movement-controls", "enabled: true");
                    rig_ppt.setAttribute("nipple-controls", "enabled: true");

                    btnBack_ppt.setAttribute("visible", false);
                });
            </script>

            <a-entity id="monitor2">
                <a-image id="monitorHealth" src="#health1" position="-2.539 1.100 -2.290" rotation="0 -0.520 0"
                    scale="0.540 0.320 1" class="raycastable"></a-image>
                <a-text value="Tahun dibentuknya BKKBN?" position="-2.792 1.220 -2.290" rotation="0 -0.520 0"
                    width="0.7" color="#222" align="left"></a-text>

                <!-- Pilihan Jawaban -->
                <a-text value="A. 1945" position="-2.773 1.172 -2.290" rotation="0 -0.520 0" width="0.7" align="left"
                    id="optA" class="raycastable" color="#007BFF"></a-text>

                <a-text value="B. 1957" position="-2.773 1.118 -2.290" rotation="0 -0.520 0" width="0.7" align="left"
                    id="optB" class="raycastable" color="#007BFF"></a-text>

                <a-text value="C. 2004" position="-2.773 1.066 -2.290" rotation="0 -0.520 0" width="0.7" align="left"
                    id="optC" class="raycastable" color="#007BFF"></a-text>

                <!-- Feedback -->
                <a-text value="" id="feedback" position="-2.785 1.012 -2.290" width="0.690" align="left" color="#000"
                    rotation="0 -0.520 0" visible="false"></a-text>

                <a-image id="backBtn2" src="#left" position="-2.790 0.975 -2.291" rotation="0 -0.520 0" width="0.2"
                    height="0.2" class="raycastable" scale="0.200 0.200 1" class="clickable" visible="false"></a-image>
            </a-entity>

            <a-image id="monitor3" src="#event1" position="-2.543 1.1 -3.668" rotation="0 -84.710 0"
                scale="0.540 0.320 1"></a-image>

            <a-image id="monitor4" src="#youth1" position="-2.036 1.100 -3.085" rotation="0 85.631 0"
                scale="0.540 0.320 1"></a-image>

            <a-image id="monitor5" src="#birth1" position="0.394 1.100 -3.612" rotation="0 -97.874 0"
                scale="0.540 0.320 1"></a-image>
        </a-entity>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const feedback = document.querySelector("#feedback");
                const monitor_health = document.querySelector("#monitorHealth")
                const camera_quiz = document.querySelector("#cam");
                const rig_quiz = document.querySelector("#rig");
                const btnBack_quiz = document.querySelector("#backBtn2")

                const rigZoomPos_quiz = "-2.553 1.100 -1.930";
                const camZoomRot_quiz = "0 -0.917 0";

                const rigInitPos_quiz = "-2.487 1.250 -1.896";
                const camInitRot_quiz = "-1.031 -1.146 0";

                // Pilihan
                const optA = document.querySelector("#optA");
                const optB = document.querySelector("#optB");
                const optC = document.querySelector("#optC");

                optA.addEventListener("click", () => {
                    feedback.setAttribute("value", "❌ Salah! Coba lagi.");
                    feedback.setAttribute("color", "#FF0000");
                    feedback.setAttribute("visible", true);
                });

                optB.addEventListener("click", () => {
                    feedback.setAttribute(
                        "value",
                        "✅ Benar! Dibentuk pada tahun 1957"
                    );
                    feedback.setAttribute("color", "#00AA00");
                    feedback.setAttribute("visible", true);
                });

                optC.addEventListener("click", () => {
                    feedback.setAttribute("value", "❌ Salah! Coba lagi.");
                    feedback.setAttribute("color", "#FF0000");
                    feedback.setAttribute("visible", true);
                });

                monitor_health.addEventListener("click", () => {
                    rig_quiz.removeAttribute("animation__pos");
                    camera_quiz.removeAttribute("animation__rot");

                    rig_quiz.setAttribute("animation__pos", {
                        property: "position",
                        to: rigZoomPos_quiz,
                        dur: 1000,
                        easing: "easeInOutQuad"
                    });

                    cam.setAttribute("animation__rot", {
                        property: "rotation",
                        to: camZoomRot_quiz,
                        dur: 1000,
                        easing: "easeInOutQuad"
                    });

                    camera_quiz.setAttribute("look-controls", "enabled: false");
                    rig_quiz.setAttribute("movement-controls", "enabled: false");
                    rig_quiz.setAttribute("nipple-controls", "enabled: false");

                    btnBack_quiz.setAttribute("visible", true)
                });

                btnBack_quiz.addEventListener("click", () => {
                    rig_quiz.removeAttribute("animation__pos");
                    camera_quiz.removeAttribute("animation__rot");

                    rig_quiz.setAttribute("animation__pos", {
                        property: "position",
                        to: rigInitPos_quiz,
                        dur: 1000,
                        easing: "easeInOutQuad"
                    });

                    cam.setAttribute("animation__rot", {
                        property: "rotation",
                        to: camInitRot_quiz,
                        dur: 1000,
                        easing: "easeInOutQuad"
                    });

                    camera_quiz.setAttribute("look-controls", "enabled: true");
                    rig_quiz.setAttribute("movement-controls", "enabled: true");
                    rig_quiz.setAttribute("nipple-controls", "enabled: true");

                    btnBack_quiz.setAttribute("visible", false)
                });
            });
        </script>

        <a-assets>
            <img src="assets/bkkbn/1.jpg" alt="" id="p1" />
            <img src="assets/bkkbn/web1.png" alt="" id="web1" />

            <img src="assets/bkkbn/p2.png" alt="" id="p2" />
            <img src="assets/bkkbn/web2.png" alt="" id="web2" />

            <img src="assets/bkkbn/p3.png" alt="" id="p3" />
            <img src="assets/bkkbn/web3.png" alt="" id="web3" />
        </a-assets>

        <!-- Monitor [2] -->
        <a-entity id="Room 1">
            <a-image id="monitorright" src="#framekanan" position="1.544 1.182 1.610" rotation="0 2.820 0"
                scale="0.540 0.320 1"></a-image>

            <a-image id="button1" src="#p1" position="1.720 1.192 1.602" rotation="0 2.820 0" scale="0.165 0.134 1"
                class="raycastable" material="opacity: 1" event-set__enter="_event: mouseenter; material.opacity: 0.6"
                event-set__leave="_event: mouseleave; material.opacity: 1"></a-image>
            <a-image id="popWeb1" src="#web1" position="1.012 1.189 1.741" rotation="0 26.394 0" visible="false"
                width="0.530" height="0.307" class="raycastable popWeb"></a-image>

            <a-image id="button2" src="#p2" position="1.543 1.218 1.611" rotation="0 2.820 0" scale="0.165 0.082 1"
                class="raycastable" material="opacity: 1" event-set__enter="_event: mouseenter; material.opacity: 0.6"
                event-set__leave="_event: mouseleave; material.opacity: 1"></a-image>
            <a-image id="popWeb2" src="#web2" position="1.012 1.189 1.741" rotation="0 26.394 0" visible="false"
                width="0.530" height="0.307" class="raycastable popWeb"></a-image>

            <a-image id="button3" src="#p3" position="1.543 1.099 1.611" rotation="0 2.820 0" scale="0.166 0.140 1"
                class="raycastable" material="opacity: 1" event-set__enter="_event: mouseenter; material.opacity: 0.6"
                event-set__leave="_event: mouseleave; material.opacity: 1"></a-image>
            <a-image id="popWeb3" src="#web3" position="1.012 1.189 1.741" rotation="0 26.394 0" visible="false"
                width="0.530" height="0.307" class="raycastable popWeb"></a-image>

            <a-image id="backButton" src="#left" position="0.799 1.179 1.847" rotation="0 26.394 0" width="0.2"
                height="0.2" class="raycastable" scale="0.200 0.200 1" class="clickable" visible="false"></a-image>

            <a-image id="monitorleft" src="" position="1.016 1.182 1.738" rotation="0 26.394 0"
                scale="0.540 0.320 1"></a-image>
        </a-entity>

        <script>
            const popWeb = document.querySelectorAll(".popWeb");
            const camera = document.querySelector("#cam");
            const rig = document.querySelector("#rig");
            const btnBack = document.querySelector("#backButton");

            const rigZoomPos = "1.147 1.185 2.037";
            const camZoomRot = "0.573 26.471 0";

            const rigInitPos = "1.211 1.25 2.202";
            const camInitRot = "0 -29.456 0";

            popWeb.forEach((el) => {
                el.addEventListener("click", () => {
                    // Hapus animasi sebelumnya
                    rig.removeAttribute("animation__pos");
                    cam.removeAttribute("animation__rot");

                    // Animasi zoom in
                    rig.setAttribute("animation__pos", {
                        property: "position",
                        to: rigZoomPos,
                        dur: 1000,
                        easing: "easeInOutQuad"
                    });

                    cam.setAttribute("animation__rot", {
                        property: "rotation",
                        to: camZoomRot,
                        dur: 1000,
                        easing: "easeInOutQuad"
                    });

                    // Disable controls
                    camera.setAttribute("look-controls", "enabled: false");
                    rig.setAttribute("movement-controls", "enabled: false");
                    rig.setAttribute("nipple-controls", "enabled: false");

                    // Tampilkan tombol back
                    btnBack.setAttribute("visible", true);
                });
            });

            btnBack.addEventListener("click", () => {
                // Hapus animasi sebelumnya
                rig.removeAttribute("animation__pos");
                camera.removeAttribute("animation__rot");

                // Animasi kembali ke awal
                rig.setAttribute("animation__pos", {
                    property: "position",
                    to: rigInitPos,
                    dur: 1000,
                    easing: "easeInOutQuad"
                });

                camera.setAttribute("animation__rot", {
                    property: "rotation",
                    to: camInitRot,
                    dur: 1000,
                    easing: "easeInOutQuad"
                });

                // Aktifkan kontrol
                camera.setAttribute("look-controls", "enabled: true");
                rig.setAttribute("movement-controls", "enabled: true");
                rig.setAttribute("nipple-controls", "enabled: true");

                // Sembunyikan tombol kembali
                btnBack.setAttribute("visible", false);
            });
        </script>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const button1 = document.querySelector("#button1");
                const button2 = document.querySelector("#button2");
                const button3 = document.querySelector("#button3");
                const popWeb1 = document.querySelector("#popWeb1");
                const popWeb2 = document.querySelector("#popWeb2");
                const popWeb3 = document.querySelector("#popWeb3");

                button1.addEventListener("click", () => {
                    const isVisible = popWeb1.getAttribute("visible");

                    // Sembunyikan semua pop-up dulu
                    popWeb1.setAttribute("visible", !isVisible);
                    popWeb2.setAttribute("visible", false);
                    popWeb3.setAttribute("visible", false);
                });

                button2.addEventListener("click", () => {
                    const isVisible = popWeb2.getAttribute("visible");

                    // Sembunyikan semua pop-up dulu
                    popWeb1.setAttribute("visible", false);
                    popWeb2.setAttribute("visible", !isVisible);
                    popWeb3.setAttribute("visible", false);
                });

                button3.addEventListener("click", () => {
                    const isVisible = popWeb3.getAttribute("visible");

                    // Sembunyikan semua pop-up dulu
                    popWeb1.setAttribute("visible", false);
                    popWeb2.setAttribute("visible", false);
                    popWeb3.setAttribute("visible", !isVisible);
                });
            });
        </script>

        <a-entity position="5.000 1.06 -1.97" geometry="primitive: box; width: 0.1; height: 2.2; depth: 10"
            material="color: #75A166;"></a-entity>

        <a-entity position="0.004 1.06 3.049" geometry="primitive: box; width: 0.1; height: 2.2; depth: 10"
            rotation="0 90 0" material="color: #75A166;"></a-entity>

        <a-entity position="0 2.2 -2" geometry="primitive: box; width: 10; height: 0.1; depth: 10"
            material="color: #ccc;"></a-entity>
    </a-scene>
</body>

</html>